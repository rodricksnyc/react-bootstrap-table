{"version":3,"file":"SelectMulti.spec.js","names":["firePasteEvent","renderWithTheme","act","cleanup","fireEvent","screen","userEvent","React","SelectMulti","beforeEach","jest","useFakeTimers","afterEach","runOnlyPendingTimers","useRealTimers","runTimers","basicOptions","label","value","describe","test","click","getByPlaceholderText","select","getByText","closest","expect","not","toHaveClass","toHaveStyle","focus","mouseDown","mouseUp","blur","document","options","fn","toBeVisible","getAllByRole","toHaveLength","TestComponent","values","setValues","useState","handleFilter","input","type","toHaveValue","cheeses","term","setTerm","useMemo","filter","cheese","toUpperCase","indexOf","bar","getAllByText","queryByText","toBeInTheDocument","keyDown","key","onChangeMock","change","target","toHaveBeenCalled","toHaveBeenCalledWith","getByRole","queryByRole","hiddenInput","getByTestId","metaKey","toHaveDisplayValue"],"sources":["../../../../src/Form/Inputs/Select/SelectMulti.spec.tsx"],"sourcesContent":["/*\n\n MIT License\n\n Copyright (c) 2022 Looker Data Sciences, Inc.\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in all\n copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n SOFTWARE.\n\n */\n\nimport { firePasteEvent, renderWithTheme } from '@looker/components-test-utils'\nimport { act, cleanup, fireEvent, screen } from '@testing-library/react'\nimport userEvent from '@testing-library/user-event'\nimport React from 'react'\n\nimport { SelectMulti } from './SelectMulti'\n\nbeforeEach(() => {\n  jest.useFakeTimers()\n})\n\nafterEach(() => {\n  jest.runOnlyPendingTimers()\n  jest.useRealTimers()\n})\n\nconst runTimers = () =>\n  act(() => {\n    jest.runOnlyPendingTimers()\n  })\n\nafterEach(cleanup)\n\nconst basicOptions = [\n  { label: 'Foo', value: 'FOO' },\n  { label: 'Bar', value: 'BAR' },\n]\n\ndescribe('SelectMulti', () => {\n  test('ripple effect', () => {\n    renderWithTheme(\n      <SelectMulti\n        options={[\n          { label: 'Cheddar', value: 'cheddar' },\n          { label: 'Gouda', value: 'gouda' },\n          { label: 'Swiss', value: 'swiss' },\n        ]}\n        placeholder=\"SelectMulti\"\n      ></SelectMulti>\n    )\n\n    fireEvent.click(screen.getByPlaceholderText('SelectMulti'))\n\n    const select = screen.getByText('Cheddar').closest('li')\n    expect(select).not.toHaveClass('bg-on fg-in')\n    expect(select).toHaveStyle({\n      '--ripple-color': '#71767a',\n      '--ripple-scale-end': '1',\n      '--ripple-scale-start': '0.1',\n      '--ripple-size': '100%',\n      '--ripple-translate': '0, 0',\n    })\n\n    select && fireEvent.focus(select)\n    expect(select).toHaveClass('bg-on')\n\n    select && fireEvent.mouseDown(select)\n    expect(select).toHaveClass('bg-on fg-in')\n\n    // foreground is locked for a minimum time to animate the ripple\n    select && fireEvent.mouseUp(select)\n    runTimers()\n    expect(select).toHaveClass('bg-on fg-out')\n    runTimers()\n    expect(select).toHaveClass('bg-on')\n\n    select && fireEvent.blur(select)\n    expect(select).not.toHaveClass('bg-on fg-in')\n    fireEvent.click(document)\n  })\n  test('values', () => {\n    const options = [\n      { label: 'Foo', value: 'FOO' },\n      { label: 'Bar', value: 'BAR' },\n      { label: 'Baz', value: 'BAZ' },\n      { label: 'Qux', value: 'QUX' },\n    ]\n    renderWithTheme(\n      <SelectMulti\n        options={options}\n        placeholder=\"Search\"\n        values={['BAZ', 'FOO']}\n        onChange={jest.fn()}\n      />\n    )\n    // should already have the 2 chips\n    expect(screen.getByText('Baz')).toBeVisible()\n    expect(screen.getByText('Foo')).toBeVisible()\n    // 2 chip remove buttons and 1 clear all button\n    expect(screen.getAllByRole('button')).toHaveLength(3)\n  })\n\n  test('defaultValues', () => {\n    const options = [\n      { label: 'Foo', value: 'FOO' },\n      { label: 'Bar', value: 'BAR' },\n      { label: 'Baz', value: 'BAZ' },\n      { label: 'Qux', value: 'QUX' },\n    ]\n    renderWithTheme(\n      <SelectMulti\n        options={options}\n        placeholder=\"Search\"\n        defaultValues={['BAR']}\n      />\n    )\n    // should already have the chip\n    expect(screen.getByText('Bar')).toBeVisible()\n    // 1 chip remove button and 1 clear all button\n    expect(screen.getAllByRole('button')).toHaveLength(2)\n  })\n\n  test('controlled value & context mismatch', () => {\n    const TestComponent = () => {\n      const [values, setValues] = React.useState<string[] | undefined>(['FOO'])\n      const handleFilter = () => {\n        // Contrived example to test how the component handles \"unexpected\" values\n        // i.e. the values prop is different from the values in context\n        // Tests a bug fix where the input value was getting lost (SELECT_SILENT)\n        setValues([])\n      }\n      return (\n        <SelectMulti\n          values={values}\n          onChange={setValues}\n          options={basicOptions}\n          isFilterable\n          onFilter={handleFilter}\n          placeholder=\"Search\"\n        />\n      )\n    }\n    renderWithTheme(<TestComponent />)\n    const input = screen.getByPlaceholderText('Search')\n    userEvent.type(input, 'b')\n    expect(input).toHaveValue('b')\n\n    fireEvent.click(document)\n  })\n\n  test('controlled, filterable', () => {\n    const cheeses = [\n      { value: 'Cheddar' },\n      { value: 'Gouda' },\n      { value: 'Swiss' },\n      { value: 'Feta' },\n      { value: 'Mascarpone' },\n      { value: 'Brie' },\n      { value: 'Mozzarella' },\n      { value: 'Cotija' },\n      { value: 'Pepperjack' },\n    ]\n\n    const TestComponent = () => {\n      const [values, setValues] = React.useState<string[] | undefined>([\n        'Cheddar',\n      ])\n      const [term, setTerm] = React.useState('')\n\n      const options = React.useMemo(() => {\n        if (term === '') return cheeses\n        return cheeses.filter(\n          cheese => cheese.value.toUpperCase().indexOf(term.toUpperCase()) > -1\n        )\n      }, [term])\n      return (\n        <SelectMulti\n          values={values}\n          onChange={setValues}\n          options={options}\n          isFilterable\n          onFilter={setTerm}\n          placeholder=\"Search\"\n        />\n      )\n    }\n\n    renderWithTheme(<TestComponent />)\n    const input = screen.getByPlaceholderText('Search')\n    userEvent.type(input, 'z')\n    // Tests a bug fix with the controlled value behavior where SELECT_SILENT\n    // was incorrectly triggered b/c the context value had '' for label\n    // when the selected option is filtered out (faulty logic in getComboboxText)\n    expect(input).toHaveValue('z')\n\n    fireEvent.click(document)\n  })\n})\n\ndescribe('closeOnSelect', () => {\n  test('false by default', () => {\n    renderWithTheme(<SelectMulti options={basicOptions} placeholder=\"Search\" />)\n\n    const input = screen.getByPlaceholderText('Search')\n    fireEvent.mouseDown(input)\n\n    const bar = screen.getByText('Bar')\n\n    expect(screen.getByText('Foo')).toBeVisible()\n    expect(bar).toBeVisible()\n\n    fireEvent.click(bar)\n\n    expect(screen.getByText('Foo')).toBeVisible()\n    expect(screen.getAllByText('Bar')).toHaveLength(2)\n\n    fireEvent.click(document)\n  })\n\n  test('true', () => {\n    renderWithTheme(\n      <SelectMulti options={basicOptions} placeholder=\"Search\" closeOnSelect />\n    )\n\n    const input = screen.getByPlaceholderText('Search')\n    fireEvent.mouseDown(input)\n\n    const bar = screen.getByText('Bar')\n\n    expect(screen.getByText('Foo')).toBeVisible()\n    expect(bar).toBeVisible()\n\n    fireEvent.click(bar)\n    // Bar is now a chip\n    expect(screen.getByText('Bar')).toBeVisible()\n    // list has closed\n    expect(screen.queryByText('Foo')).not.toBeInTheDocument()\n\n    fireEvent.click(document)\n  })\n\n  describe('removeOnBackspace', () => {\n    test('true by default', () => {\n      renderWithTheme(\n        <SelectMulti\n          options={basicOptions}\n          defaultValues={['FOO', 'BAR']}\n          placeholder=\"Search\"\n        />\n      )\n\n      const input = screen.getByPlaceholderText('Search')\n\n      expect(screen.getByText('Foo')).toBeVisible()\n      expect(screen.getByText('Bar')).toBeVisible()\n\n      fireEvent.keyDown(input, {\n        key: 'Backspace',\n      })\n\n      expect(screen.getByText('Foo')).toBeVisible()\n      expect(screen.queryByText('Bar')).not.toBeInTheDocument()\n    })\n\n    test('false', () => {\n      renderWithTheme(\n        <SelectMulti\n          options={basicOptions}\n          defaultValues={['FOO', 'BAR']}\n          placeholder=\"Search\"\n          removeOnBackspace={false}\n        />\n      )\n\n      const input = screen.getByPlaceholderText('Search')\n\n      expect(screen.getByText('Foo')).toBeVisible()\n      expect(screen.getByText('Bar')).toBeVisible()\n\n      fireEvent.keyDown(input, {\n        key: 'Backspace',\n      })\n\n      expect(screen.getByText('Foo')).toBeVisible()\n      expect(screen.queryByText('Bar')).toBeVisible()\n    })\n  })\n\n  describe('freeInput', () => {\n    test('false by default', () => {\n      const onChangeMock = jest.fn()\n      renderWithTheme(\n        <SelectMulti\n          options={basicOptions}\n          defaultValues={['FOO', 'BAR']}\n          placeholder=\"Search\"\n          onChange={onChangeMock}\n        />\n      )\n\n      const input = screen.getByPlaceholderText('Search')\n      fireEvent.change(input, { target: { value: 'baz,qux,' } })\n\n      expect(onChangeMock).not.toHaveBeenCalled()\n      expect(input).toHaveValue('baz,qux,')\n\n      fireEvent.click(document)\n    })\n\n    test('true', () => {\n      const onChangeMock = jest.fn()\n      renderWithTheme(\n        <SelectMulti\n          options={basicOptions}\n          defaultValues={['FOO', 'BAR']}\n          placeholder=\"Search\"\n          onChange={onChangeMock}\n          freeInput\n        />\n      )\n\n      const input = screen.getByPlaceholderText('Search')\n\n      // Whitespace trimmed by default\n      fireEvent.change(input, { target: { value: ' baz , qux,' } })\n\n      expect(onChangeMock).toHaveBeenCalledWith(['FOO', 'BAR', 'baz', 'qux'])\n      expect(input).toHaveValue('')\n\n      fireEvent.click(document)\n    })\n\n    test('formatInputValue false', () => {\n      const onChangeMock = jest.fn()\n      renderWithTheme(\n        <SelectMulti\n          options={basicOptions}\n          defaultValues={['FOO', 'BAR']}\n          placeholder=\"Search\"\n          onChange={onChangeMock}\n          freeInput\n          formatInputValue={false}\n        />\n      )\n\n      const input = screen.getByPlaceholderText('Search')\n      fireEvent.change(input, { target: { value: ' baz , qux,' } })\n\n      expect(onChangeMock).toHaveBeenCalledWith(['FOO', 'BAR', ' baz ', ' qux'])\n      expect(input).toHaveValue('')\n\n      fireEvent.click(document)\n    })\n\n    test('creates value and closes list on blur', async () => {\n      const onChangeMock = jest.fn()\n      renderWithTheme(\n        <>\n          <button>A random button</button>\n          <SelectMulti\n            options={basicOptions}\n            placeholder=\"Search\"\n            onChange={onChangeMock}\n            freeInput\n          />\n        </>\n      )\n\n      const input = screen.getByPlaceholderText('Search')\n      input.focus()\n      fireEvent.change(input, { target: { value: 'baz' } })\n      expect(screen.getByRole('listbox')).toBeVisible()\n      screen.getByText('A random button').focus()\n\n      expect(onChangeMock).toHaveBeenCalledWith(['baz'])\n      expect(input).toHaveValue('')\n\n      expect(screen.queryByRole('listbox')).not.toBeInTheDocument()\n    })\n\n    test('copy/paste', () => {\n      const onChangeMock = jest.fn()\n      renderWithTheme(\n        <SelectMulti\n          options={basicOptions}\n          values={['FOO', 'BAR']}\n          onChange={onChangeMock}\n          placeholder=\"Search\"\n          freeInput\n        />\n      )\n\n      const input = screen.getByPlaceholderText('Search')\n      const hiddenInput = screen.getByTestId('hidden-input')\n\n      fireEvent.keyDown(input, { key: 'a', metaKey: true })\n      // testing the hidden input value b/c jsdom do clipboard\n      expect(hiddenInput).toHaveDisplayValue(\n        '[{\"label\":\"Foo\",\"value\":\"FOO\"},{\"label\":\"Bar\",\"value\":\"BAR\"}]'\n      )\n\n      firePasteEvent(\n        input,\n        '[{\"label\":\"Baz\",\"value\":\"BAZ\"},{\"label\":\"Qux\",\"value\":\"QUX\"}]'\n      )\n      fireEvent.change(input, {\n        target: {\n          value:\n            '[{\"label\":\"Baz\",\"value\":\"BAZ\"},{\"label\":\"Qux\",\"value\":\"QUX\"}]',\n        },\n      })\n      expect(onChangeMock).toHaveBeenCalledWith(['FOO', 'BAR', 'BAZ', 'QUX'])\n    })\n  })\n})\n"],"mappings":"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"}